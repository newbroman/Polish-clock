<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Polish Time Master</title>
    <style>
        :root { --bg: #f8f9fa; --card: #ffffff; --text: #212529; --accent: #dc3545; --clock-border: #d1d1d1; --btn-sub: #e9ecef; --help-bg: #fff; --eng-text: #6c757d; }
        body.dark-mode { --bg: #121212; --card: #1e1e1e; --text: #e0e0e0; --clock-border: #444; --btn-sub: #333; --help-bg: #1e1e1e; --eng-text: #a0a0a0; }
        
        body { font-family: -apple-system, sans-serif; background-color: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; margin: 0; padding-top: 10px; touch-action: manipulation; }
        .container { background: var(--card); padding: 1rem; border-radius: 20px; box-shadow: 0 8px 30px rgba(0,0,0,0.1); width: 300px; text-align: center; position: relative; }
        
        #clock-container { width: 140px; height: 140px; margin: 5px auto 10px; position: relative; border-radius: 50%; border: 6px solid var(--clock-border); background: linear-gradient(to bottom, #ffffff 50%, #dc3545 50%); overflow: hidden; }
        .mark { position: absolute; width: 2px; height: 8px; background: #212529; left: 50%; transform-origin: 50% 70px; }
        .mark.hour { width: 3px; height: 12px; }
        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; background: #212529; border-radius: 10px; transition: transform 0.4s; }
        .hour-hand { width: 6px; height: 35px; margin-left: -3px; z-index: 2; }
        .min-hand { width: 3px; height: 50px; margin-left: -1.5px; z-index: 1; }
        .dot { width: 10px; height: 10px; background: #212529; position: absolute; top:50%; left:50%; transform: translate(-50%, -50%); border-radius: 50%; z-index: 10; border: 1.5px solid white; }

        .picker-container { display: flex; flex-direction: column; align-items: center; margin-bottom: 10px; }
        .picker-row { display: flex; gap: 20px; }
        .picker-btn { background: #333; color: white; border: none; border-radius: 5px; width: 50px; height: 35px; font-weight: bold; font-size: 1.3rem; display: flex; align-items: center; justify-content: center; }
        .digital-display { background: #1a1a1a; color: #00ff00; font-family: monospace; font-size: 1.5rem; padding: 8px 15px; border-radius: 8px; border: 2px solid #333; margin: 4px 0; min-width: 100px; }

        .display-area { min-height: 85px; margin: 5px 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .polish-display { font-size: 1rem; font-weight: 700; color: var(--accent); line-height: 1.2; padding: 0 5px; }
        .english-display { font-size: 0.8rem; color: var(--eng-text); font-style: italic; }
        
        button { cursor: pointer; font-weight: 700; border-radius: 10px; border: none; padding: 10px; transition: 0.1s; width: 100%; margin-bottom: 6px; font-size: 0.85rem; }
        .btn-main { background: var(--accent); color: white; }
        .btn-real { background: #007bff; color: white; }
        .btn-sub { background: var(--btn-sub); color: var(--text); padding: 6px; font-size: 0.7rem; }
        
        .top-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; margin-bottom: 10px; }
        .setting-row { display: flex; justify-content: space-around; align-items: center; font-size: 0.8rem; margin-bottom: 10px; padding: 6px; background: rgba(0,0,0,0.05); border-radius: 10px; }
        
        #help-modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--help-bg); border-radius: 20px; z-index: 100; padding: 20px; box-sizing: border-box; overflow-y: auto; text-align: left; }
        .help-section { margin-bottom: 15px; border-left: 3px solid var(--accent); padding-left: 10px; }
        .help-section h3 { font-size: 0.85rem; margin: 0 0 5px 0; color: var(--accent); text-transform: uppercase; }
        .example { color: #666; font-style: italic; display: block; margin-top: 2px; font-size: 0.75rem; }
    </style>
</head>
<body onload="init()">

<div class="container">
    <div class="top-row">
        <button class="btn-sub" onclick="toggleDark()">ğŸŒ“</button>
        <button class="btn-sub" onclick="toggleLang()">EN/PL</button>
        <button class="btn-sub" id="quiz-toggle" onclick="toggleQuiz()">Quiz</button>
        <button class="btn-sub" onclick="toggleHelp()">â“</button>
    </div>

    <div id="clock-container"><div class="dot"></div><div class="hand hour-hand" id="h-hand"></div><div class="hand min-hand" id="m-hand"></div></div>

    <div class="picker-container">
        <div class="picker-row"><button class="picker-btn" onclick="adjTime(1, 0)">+</button><button class="picker-btn" onclick="adjTime(0, 5)">+</button></div>
        <div class="digital-display"><span id="digi-time">12:00</span><span style="font-size:0.7rem; color:#888; margin-left:4px" id="ampm">PM</span></div>
        <div class="picker-row"><button class="picker-btn" onclick="adjTime(-1, 0)">-</button><button class="picker-btn" onclick="adjTime(0, -5)">-</button></div>
    </div>

    <div class="display-area">
        <div class="polish-display" id="polish-text">DzieÅ„ dobry!</div>
        <div class="english-display" id="english-text">Good morning!</div>
        <button id="reveal-btn" style="display:none; background:#28a745; color:white; margin-top:5px;" onclick="revealAnswer()">REVEAL</button>
    </div>

    <div class="setting-row">
        <label><input type="radio" name="mode" id="casual" checked onchange="updateDisplay()"> <span id="label-casual">Casual</span></label>
        <label><input type="radio" name="mode" id="formal" onchange="updateDisplay()"> <span id="label-formal">Formal</span></label>
        <button class="btn-sub" id="format-toggle" style="width:55px; margin:0;" onclick="toggleFormat()">12H</button>
    </div>

    <button class="btn-real" id="btn-real" onclick="setRealTime()">ACTUAL TIME</button>
    <button class="btn-main" id="btn-random" onclick="rollTime()">RANDOM TIME</button>
    
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:6px;">
        <button class="btn-sub" id="btn-repeat" onclick="speak(1)">ğŸ”Š REPEAT</button>
        <button class="btn-sub" id="btn-slow" onclick="speak(0.5)">Â½ SPEED</button>
    </div>

    <div id="help-modal">
        <h2 id="help-title" style="font-size: 1.1rem; margin-top:0; color: var(--accent);">Help</h2>
        <div id="help-content"></div>
        <button class="btn-main" style="margin-top:10px" id="help-close-btn" onclick="toggleHelp()">Close</button>
    </div>
</div>

<script>
    let hours = 12, minutes = 0, isQuiz = false, isRevealed = true, is24h = false, currentLang = 'EN';
    const hNom = ["pÃ³Å‚noc", "pierwsza", "druga", "trzecia", "czwarta", "piÄ…ta", "szÃ³sta", "siÃ³dma", "Ã³sma", "dziewiÄ…ta", "dziesiÄ…ta", "jedenasta", "poÅ‚udnie", "trzynasta", "czternasta", "piÄ™tnasta", "szesnasta", "siedemnasta", "osiemnasta", "dziewiÄ™tnasta", "dwudziesta", "dwudziesta pierwsza", "dwudziesta druga", "dwudziesta trzecia"];
    const hGen = ["pÃ³Å‚nocy", "pierwszej", "drugiej", "trzeciej", "czwartej", "piÄ…tej", "szÃ³stej", "siÃ³dmej", "Ã³smej", "dziewiÄ…tej", "dziesiÄ…tej", "jedenastej", "poÅ‚udnia", "trzynastej", "czternastej", "piÄ™tnastej", "szesnastej", "siedemnastej", "osiemnastej", "dziewiÄ™tnastej", "dwudziestej", "dwudziestej pierwszej", "dwudziestej drugiej", "dwudziestej trzeciej"];
    const mWords = ["", "jedna", "dwie", "trzy", "cztery", "piÄ™Ä‡", "szeÅ›Ä‡", "siedem", "osiem", "dziewiÄ™Ä‡", "dziesiÄ™Ä‡", "jedenaÅ›cie", "dwanaÅ›cie", "trzynaÅ›cie", "czternaÅ›cie", "piÄ™tnaÅ›cie", "szesnaÅ›cie", "siedemnaÅ›cie", "osiemnaÅ›cie", "dziewiÄ™tnasta", "dwadzieÅ›cia", "dwadzieÅ›cia jeden", "dwadzieÅ›cia dwie", "dwadzieÅ›cia trzy", "dwadzieÅ›cia cztery", "dwadzieÅ›cia piÄ™Ä‡", "dwadzieÅ›cia szeÅ›Ä‡", "dwadzieÅ›cia siedem", "dwadzieÅ›cia osiem", "dwadzieÅ›cia dziewiÄ™Ä‡", "trzydzieÅ›ci", "trzydzieÅ›ci jeden", "trzydzieÅ›ci dwie", "trzydzieÅ›ci trzy", "trzydzieÅ›ci cztery", "trzydzieÅ›ci piÄ™Ä‡", "trzydzieÅ›ci szeÅ›Ä‡", "trzydzieÅ›ci siedem", "trzydzieÅ›ci osiem", "trzydzieÅ›ci dziewiÄ™Ä‡", "czterdzieÅ›ci", "czterdzieÅ›ci jeden", "czterdzieÅ›ci dwie", "czterdzieÅ›ci trzy", "czterdzieÅ›ci cztery", "czterdzieÅ›ci piÄ™Ä‡", "czterdzieÅ›ci szeÅ›Ä‡", "czterdzieÅ›ci siedem", "czterdzieÅ›ci osiem", "czterdzieÅ›ci dziewiÄ™Ä‡", "piÄ™Ä‡dziesiÄ…t", "piÄ™Ä‡dziesiÄ…t jeden", "piÄ™Ä‡dziesiÄ…t dwie", "piÄ™Ä‡dziesiÄ…t trzy", "piÄ™Ä‡dziesiÄ…t cztery", "piÄ™Ä‡dziesiÄ…t piÄ™Ä‡", "piÄ™Ä‡dziesiÄ…t szeÅ›Ä‡", "piÄ™Ä‡dziesiÄ…t siedem", "piÄ™Ä‡dziesiÄ…t osiem", "piÄ™Ä‡dziesiÄ…t dziewiÄ™Ä‡"];

    const dict = {
        EN: {
            title: "Polish Time Guide", casual: "Casual", formal: "Formal", actual: "ACTUAL TIME", random: "RANDOM TIME",
            repeat: "ğŸ”Š REPEAT", slow: "Â½ SPEED", quizOn: "Quiz: ON", quizOff: "Quiz: OFF", reveal: "REVEAL", ask: "How to say?", close: "Close",
            help: `<div class="help-section"><h3>How to Use</h3><p>â€¢ Use <b>+</b> and <b>-</b> buttons to change time.<br>â€¢ Use RANDOM to practice.<br>â€¢ QUIZ hides text until you tap REVEAL.</p></div><div class="help-section"><h3>Grammar Rules</h3><p><b>1. Minutes 1-29:</b> Use <i>po</i> (after) + Genitive hour.<br><span class="example">5:10 â†’ DziesiÄ™Ä‡ po piÄ…tej</span><b>2. Half Hour:</b> Use <i>WpÃ³Å‚ do</i> + Genitive NEXT hour.<br><span class="example">5:30 â†’ WpÃ³Å‚ do szÃ³stej</span><b>3. Minutes 31-59:</b> Use <i>Za</i> (before) + Nominative NEXT hour.<br><span class="example">5:45 â†’ Za piÄ™tnaÅ›cie szÃ³sta</span></p></div>`
        },
        PL: {
            title: "Przewodnik Czasu", casual: "Potoczny", formal: "Oficjalny", actual: "AKTUALNY CZAS", random: "LOSUJ CZAS",
            repeat: "ğŸ”Š POWTÃ“RZ", slow: "Â½ PRÄ˜DKOÅšÄ†", quizOn: "Quiz: WÅ", quizOff: "Quiz: WYÅ", reveal: "POKAÅ»", ask: "Jak to powiedzieÄ‡?", close: "Zamknij",
            help: `<div class="help-section"><h3>Jak uÅ¼ywaÄ‡</h3><p>â€¢ UÅ¼yj przyciskÃ³w <b>+</b> i <b>-</b> aby zmieniÄ‡ czas.<br>â€¢ LOSUJ aby Ä‡wiczyÄ‡.<br>â€¢ QUIZ ukrywa tekst do klikniÄ™cia POKAÅ».</p></div><div class="help-section"><h3>Zasady Gramatyki</h3><p><b>1. Minuty 1-29:</b> po + DopeÅ‚niacz godziny.<br><span class="example">5:10 â†’ DziesiÄ™Ä‡ po piÄ…tej</span><b>2. PÃ³Å‚ godziny:</b> WpÃ³Å‚ do + DopeÅ‚niacz nastÄ™pnej.<br><span class="example">5:30 â†’ WpÃ³Å‚ do szÃ³stej</span><b>3. Minuty 31-59:</b> Za + Mianownik nastÄ™pnej.<br><span class="example">5:45 â†’ Za piÄ™tnaÅ›cie szÃ³sta</span></p></div>`
        }
    };

    function init() { 
        const container = document.getElementById('clock-container');
        for (let i = 0; i < 12; i++) {
            const mark = document.createElement('div');
            mark.className = 'mark' + (i % 3 === 0 ? ' hour' : '');
            mark.style.transform = `rotate(${i * 30}deg)`;
            container.appendChild(mark);
        }
        setRealTime(); updateUI(); 
    }

    function adjTime(h, m) { hours = (hours + h + 24) % 24; minutes = (minutes + m + 60) % 60; isRevealed = !isQuiz; updateDisplay(); if(!isQuiz) speak(1); }
    function toggleLang() { currentLang = (currentLang === 'EN' ? 'PL' : 'EN'); updateUI(); }
    function toggleFormat() { is24h = !is24h; document.getElementById('format-toggle').innerText = is24h ? "24H" : "12H"; updateDisplay(); }
    function toggleQuiz() { isQuiz = !isQuiz; isRevealed = !isQuiz; updateUI(); }
    function toggleHelp() { const m = document.getElementById('help-modal'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; }
    function toggleDark() { document.body.classList.toggle('dark-mode'); }

    function updateUI() {
        const d = dict[currentLang];
        document.getElementById('label-casual').innerText = d.casual;
        document.getElementById('label-formal').innerText = d.formal;
        document.getElementById('btn-real').innerText = d.actual;
        document.getElementById('btn-random').innerText = d.random;
        document.getElementById('btn-repeat').innerText = d.repeat;
        document.getElementById('btn-slow').innerText = d.slow;
        document.getElementById('help-close-btn').innerText = d.close;
        document.getElementById('help-title').innerText = d.title;
        document.getElementById('quiz-toggle').innerText = isQuiz ? d.quizOn : d.quizOff;
        document.getElementById('reveal-btn').innerText = d.reveal;
        document.getElementById('help-content').innerHTML = d.help;
        updateDisplay();
    }

    function setRealTime() { const n = new Date(); hours = n.getHours(); minutes = n.getMinutes(); isRevealed = !isQuiz; updateDisplay(); }
    function rollTime() { hours = Math.floor(Math.random() * 24); minutes = Math.floor(Math.random() * 60); isRevealed = !isQuiz; updateDisplay(); if(!isQuiz) speak(1); }
    function revealAnswer() { isRevealed = true; updateDisplay(); speak(1); }

    function updateDisplay() {
        document.getElementById('h-hand').style.transform = `rotate(${(hours % 12) * 30 + minutes * 0.5}deg)`;
        document.getElementById('m-hand').style.transform = `rotate(${minutes * 6}deg)`;
        let displayHours = is24h ? hours : (hours % 12 || 12);
        document.getElementById('digi-time').innerText = `${displayHours}:${minutes.toString().padStart(2, '0')}`;
        document.getElementById('ampm').innerText = is24h ? "" : (hours >= 12 ? "PM" : "AM");
        
        const formal = document.getElementById('formal').checked;
        let curH = is24h ? hours : (hours % 12);
        let nextH = (hours + 1) % 24;
        let nextH_Spoken = is24h ? nextH : (nextH % 12);

        let polish = "", english = "";
        if (formal) {
            polish = `Godzina ${hNom[hours]} ${mWords[minutes]}`;
            english = `${hours}:${minutes.toString().padStart(2, '0')}`;
        } else {
            if (minutes === 0) { 
                polish = (curH === 0 && hours === 0) ? `Jest pÃ³Å‚noc` : (curH === 12 && hours === 12) ? `Jest poÅ‚udnie` : `Jest ${hNom[curH]}`;
                english = `It's ${hours === 0 ? 'midnight' : hours === 12 ? 'noon' : (hours % 12 || 12) + " o'clock"}`;
            }
            else if (minutes < 30) { polish = `${mWords[minutes]} po ${hGen[curH]}`; english = `${minutes} past ${hours % 12 || 12}`; }
            else if (minutes === 30) { polish = `WpÃ³Å‚ do ${hGen[nextH_Spoken]}`; english = `Half to ${nextH % 12 || 12}`; }
            else { polish = `Za ${mWords[60 - minutes]} ${hNom[nextH_Spoken]}`; english = `${60-minutes} to ${nextH % 12 || 12}`; }
        }

        const pTxt = document.getElementById('polish-text');
        const eTxt = document.getElementById('english-text');
        if (isQuiz && !isRevealed) { pTxt.innerText = dict[currentLang].ask; eTxt.innerText = ""; document.getElementById('reveal-btn').style.display = "block"; }
        else { pTxt.innerText = polish; eTxt.innerText = english; document.getElementById('reveal-btn').style.display = "none"; }
    }

    function speak(r) { window.speechSynthesis.cancel(); const t = document.getElementById('polish-text').innerText; if (t.includes("?")) return; const m = new SpeechSynthesisUtterance(t); m.lang = 'pl-PL'; m.rate = r; window.speechSynthesis.speak(m); }
</script>
</body>
</html>
