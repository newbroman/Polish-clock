<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Polish Time Master</title>
    <style>
        :root { --bg: #f8f9fa; --card: #ffffff; --text: #212529; --accent: #dc3545; --clock-bg: #ffffff; --btn-sub: #e9ecef; }
        body.dark-mode { --bg: #121212; --card: #1e1e1e; --text: #e0e0e0; --clock-bg: #2d2d2d; --btn-sub: #333; }
        
        body { font-family: -apple-system, system-ui, sans-serif; background-color: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; touch-action: manipulation; overflow: hidden; }
        .container { background: var(--card); padding: 1.2rem; border-radius: 24px; box-shadow: 0 12px 40px rgba(0,0,0,0.12); width: 315px; text-align: center; position: relative; }
        
        /* Interactive Digital Box */
        .digital-box { background: #1a1a1a; color: #00ff00; font-family: monospace; font-size: 1.5rem; padding: 10px; border-radius: 10px; display: inline-flex; align-items: center; margin-bottom: 12px; border: 2px solid #333; position: relative; cursor: pointer; }
        .digital-box input[type="time"] { position: absolute; opacity: 0; width: 100%; height: 100%; left: 0; top: 0; cursor: pointer; }
        .ampm-label { font-size: 0.8rem; color: #888; margin-left: 5px; pointer-events: none; }

        #clock-container { width: 110px; height: 110px; background: var(--clock-bg); border: 5px solid var(--accent); border-radius: 50%; margin: 10px auto; position: relative; }
        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; background: var(--text); border-radius: 10px; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .hour-hand { width: 4px; height: 28px; margin-left: -2px; z-index: 2; }
        .min-hand { width: 3px; height: 42px; margin-left: -1.5px; z-index: 1; }
        .dot { width: 8px; height: 8px; background: var(--accent); position: absolute; top:50%; left:50%; transform: translate(-50%, -50%); border-radius: 50%; z-index: 10; }

        .polish-display { min-height: 75px; margin: 10px 0; font-size: 1.1rem; font-weight: 700; color: var(--accent); display: flex; align-items: center; justify-content: center; padding: 0 10px; line-height: 1.2; }
        
        button { cursor: pointer; font-weight: 700; border-radius: 12px; border: none; padding: 12px; transition: 0.1s; width: 100%; margin-bottom: 8px; -webkit-tap-highlight-color: transparent; }
        button:disabled { opacity: 0.3; cursor: not-allowed; }
        button:active:not(:disabled) { transform: scale(0.96); }
        .btn-main { background: var(--accent); color: white; }
        .btn-real { background: #007bff; color: white; }
        .btn-sub { background: var(--btn-sub); color: var(--text); font-size: 0.75rem; padding: 8px; }
        
        #help-modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--card); border-radius: 24px; z-index: 100; padding: 20px; box-sizing: border-box; overflow-y: auto; text-align: left; }
        
        .top-row { display: flex; gap: 5px; margin-bottom: 10px; }
        .btn-group { display: flex; gap: 5px; }
        .setting-row { display: flex; justify-content: space-around; align-items: center; font-size: 0.85rem; margin-bottom: 12px; padding: 8px; background: rgba(0,0,0,0.05); border-radius: 12px; }
    </style>
</head>
<body onload="init()">

<div class="container">
    <div id="help-modal">
        <h2 id="h-title">Grammar Help</h2>
        <div id="h-content"></div>
        <button class="btn-main" onclick="toggleHelp()" id="h-close">Close</button>
    </div>

    <div class="top-row">
        <button class="btn-sub" onclick="toggleDark()">ğŸŒ“ Theme</button>
        <button class="btn-sub" id="lang-toggle" onclick="toggleLang()">EN / PL</button>
        <button class="btn-sub" id="quiz-toggle" onclick="toggleQuiz()">Quiz: OFF</button>
        <button class="btn-sub" onclick="toggleHelp()">â“</button>
    </div>

    <div class="digital-box">
        <input type="time" id="time-picker" oninput="manualTime(this.value)">
        <span id="digi-time">--:--</span><span class="ampm-label" id="ampm">--</span>
    </div>

    <div id="clock-container">
        <div class="dot"></div>
        <div class="hand hour-hand" id="h-hand"></div>
        <div class="hand min-hand" id="m-hand"></div>
    </div>

    <div class="polish-display" id="polish-text">Loading...</div>
    
    <button id="reveal-btn" style="display:none; background:#28a745; color:white;" onclick="revealAnswer()">REVEAL ANSWER</button>

    <div class="setting-row">
        <div>
            <input type="radio" name="mode" id="casual" checked onchange="handleModeChange()"> <span id="lbl-casual">Casual</span>
            <input type="radio" name="mode" id="formal" onchange="handleModeChange()"> <span id="lbl-formal">Formal</span>
        </div>
        <button class="btn-sub" id="format-toggle" style="width:65px; margin:0; border:1px solid #ccc;" onclick="toggleFormat()">12H</button>
    </div>

    <button class="btn-real" id="btn-real" onclick="setRealTime()">ACTUAL TIME</button>
    <button class="btn-main" id="btn-random" onclick="rollTime()">RANDOM TIME</button>
    
    <div class="btn-group">
        <button class="btn-sub" id="btn-repeat" onclick="speak(1)">ğŸ”Š REPEAT</button>
        <button class="btn-sub" id="btn-slow" onclick="speak(0.5)">Â½ SPEED</button>
    </div>
</div>

<script>
    let hours = 0, minutes = 0, isQuiz = false, isRevealed = true, currentLang = 'EN', is24h = false;
    
    const hNom = ["pÃ³Å‚noc", "pierwsza", "druga", "trzecia", "czwarta", "piÄ…ta", "szÃ³sta", "siÃ³dma", "Ã³sma", "dziewiÄ…ta", "dziesiÄ…ta", "jedenasta", "poÅ‚udnie", "trzynasta", "czternasta", "piÄ™tnasta", "szesnasta", "siedemnasta", "osiemnasta", "dziewiÄ™tnasta", "dwudziesta", "dwudziesta pierwsza", "dwudziesta druga", "dwudziesta trzecia"];
    const hGen = ["pÃ³Å‚nocy", "pierwszej", "drugiej", "trzeciej", "czwartej", "piÄ…tej", "szÃ³stej", "siÃ³dmej", "Ã³smej", "dziewiÄ…tej", "dziesiÄ…tej", "jedenastej", "poÅ‚udnia", "trzynastej", "czternastej", "piÄ™tnastej", "szesnastej", "siedemnastej", "osiemnastej", "dziewiÄ™tnastej", "dwudziestej", "dwudziestej pierwszej", "dwudziestej drugiej", "dwudziestej trzeciej"];
    const mWords = ["", "jedna", "dwie", "trzy", "cztery", "piÄ™Ä‡", "szeÅ›Ä‡", "siedem", "osiem", "dziewiÄ™Ä‡", "dziesiÄ™Ä‡", "jedenaÅ›cie", "dwanaÅ›cie", "trzynaÅ›cie", "czternaÅ›cie", "piÄ™tnaÅ›cie", "szesnaÅ›cie", "siedemnaÅ›cie", "osiemnaÅ›cie", "dziewiÄ™tnaÅ›cie", "dwadzieÅ›cia", "dwadzieÅ›cia jeden", "dwadzieÅ›cia dwie", "dwadzieÅ›cia trzy", "dwadzieÅ›cia cztery", "dwadzieÅ›cia piÄ™Ä‡", "dwadzieÅ›cia szeÅ›Ä‡", "dwadzieÅ›cia siedem", "dwadzieÅ›cia osiem", "dwadzieÅ›cia dziewiÄ™Ä‡", "trzydzieÅ›ci", "trzydzieÅ›ci jeden", "trzydzieÅ›ci dwie", "trzydzieÅ›ci trzy", "trzydzieÅ›ci cztery", "trzydzieÅ›ci piÄ™Ä‡", "trzydzieÅ›ci szeÅ›Ä‡", "trzydzieÅ›ci siedem", "trzydzieÅ›ci osiem", "trzydzieÅ›ci dziewiÄ™Ä‡", "czterdzieÅ›ci", "czterdzieÅ›ci jeden", "czterdzieÅ›ci dwie", "czterdzieÅ›ci trzy", "czterdzieÅ›ci cztery", "czterdzieÅ›ci piÄ™Ä‡", "czterdzieÅ›ci szeÅ›Ä‡", "czterdzieÅ›ci siedem", "czterdzieÅ›ci osiem", "czterdzieÅ›ci dziewiÄ™Ä‡", "piÄ™Ä‡dziesiÄ…t", "piÄ™Ä‡dziesiÄ…t jeden", "piÄ™Ä‡dziesiÄ…t dwie", "piÄ™Ä‡dziesiÄ…t trzy", "piÄ™Ä‡dziesiÄ…t cztery", "piÄ™Ä‡dziesiÄ…t piÄ™Ä‡", "piÄ™Ä‡dziesiÄ…t szeÅ›Ä‡", "piÄ™Ä‡dziesiÄ…t siedem", "piÄ™Ä‡dziesiÄ…t osiem", "piÄ™Ä‡dziesiÄ…t dziewiÄ™Ä‡"];

    const dict = {
        EN: { real: "ACTUAL TIME", random: "RANDOM TIME", reveal: "REVEAL ANSWER", repeat: "ğŸ”Š REPEAT", slow: "Â½ SPEED", casual: "Casual", formal: "Formal", qOn: "Quiz: ON", qOff: "Quiz: OFF", qAsk: "How do you say this?", hTitle: "Grammar Help", hClose: "Close", hBody: `<p><b>Manual Input:</b> Tap the green digital clock to pick a specific time.</p><hr><p><b>1-29 mins:</b> 'po' + Genitive hour.</p><p><b>30 mins:</b> 'wpÃ³Å‚ do' + Genitive NEXT hour.</p><p><b>31-59 mins:</b> 'za' + Nominative NEXT hour.</p>` },
        PL: { real: "CZAS RZECZYWISTY", random: "LOSUJ CZAS", reveal: "POKAÅ» ODPOWIEDÅ¹", repeat: "ğŸ”Š POWTÃ“RZ", slow: "Â½ PRÄ˜DKOÅšÄ†", casual: "Potoczny", formal: "Oficjalny", qOn: "Quiz: WÅ", qOff: "Quiz: WYÅ", qAsk: "Jak to powiedzieÄ‡?", hTitle: "Pomoc gramatyczna", hClose: "Zamknij", hBody: `<p><b>WybÃ³r rÄ™czny:</b> Kliknij zielony zegar, aby ustawiÄ‡ konkretnÄ… godzinÄ™.</p><hr><p><b>1-29 min:</b> 'po' + dopeÅ‚niacz.</p><p><b>30 min:</b> 'wpÃ³Å‚ do' + dopeÅ‚niacz NASTÄ˜PNEJ godziny.</p><p><b>31-59 min:</b> 'za' + mianownik NASTÄ˜PNEJ godziny.</p>` }
    };

    function init() { updateLangUI(); setRealTime(); }

    function manualTime(val) {
        if (!val) return;
        const [h, m] = val.split(':');
        hours = parseInt(h);
        minutes = parseInt(m);
        isRevealed = !isQuiz;
        updateDisplay();
        if(!isQuiz) speak(1);
    }

    function updateLangUI() {
        const t = dict[currentLang];
        document.getElementById('btn-real').innerText = t.real;
        document.getElementById('btn-random').innerText = t.random;
        document.getElementById('reveal-btn').innerText = t.reveal;
        document.getElementById('btn-repeat').innerText = t.repeat;
        document.getElementById('btn-slow').innerText = t.slow;
        document.getElementById('lbl-casual').innerText = t.casual;
        document.getElementById('lbl-formal').innerText = t.formal;
        document.getElementById('h-title').innerText = t.hTitle;
        document.getElementById('h-close').innerText = t.hClose;
        document.getElementById('h-content').innerHTML = t.hBody;
        document.getElementById('quiz-toggle').innerText = isQuiz ? t.qOn : t.qOff;
    }

    function toggleLang() {
        currentLang = (currentLang === 'EN') ? 'PL' : 'EN';
        updateLangUI();
        updateDisplay();
    }

    function handleModeChange() {
        const isFormal = document.getElementById('formal').checked;
        const fmtBtn = document.getElementById('format-toggle');
        if (isFormal) {
            fmtBtn.disabled = true;
            fmtBtn.innerText = "24H";
        } else {
            fmtBtn.disabled = false;
            fmtBtn.innerText = is24h ? "24H" : "12H";
        }
        updateDisplay();
    }

    function toggleFormat() {
        is24h = !is24h;
        document.getElementById('format-toggle').innerText = is24h ? "24H" : "12H";
        updateDisplay();
    }

    function setRealTime() {
        const now = new Date(); 
        hours = now.getHours(); 
        minutes = now.getMinutes();
        isRevealed = !isQuiz; 
        updateDisplay();
    }

    function rollTime() {
        hours = Math.floor(Math.random() * 24); 
        minutes = Math.floor(Math.random() * 60);
        isRevealed = !isQuiz; 
        updateDisplay();
        if(!isQuiz) speak(1);
    }

    function toggleQuiz() {
        isQuiz = !isQuiz; isRevealed = !isQuiz;
        document.getElementById('quiz-toggle').innerText = isQuiz ? dict[currentLang].qOn : dict[currentLang].qOff;
        updateDisplay();
    }

    function revealAnswer() { isRevealed = true; updateDisplay(); speak(1); }

    function updateDisplay() {
        document.getElementById('h-hand').style.transform = `rotate(${(hours % 12) * 30 + minutes * 0.5}deg)`;
        document.getElementById('m-hand').style.transform = `rotate(${minutes * 6}deg)`;
        document.getElementById('digi-time').innerText = `${hours % 12 || 12}:${minutes.toString().padStart(2, '0')}`;
        document.getElementById('ampm').innerText = hours >= 12 ? "PM" : "AM";

        const isFormal = document.getElementById('formal').checked;
        let polish = "";
        let displayHour = hours;
        if (!isFormal && !is24h) displayHour = hours % 12;

        if (isFormal) { 
            polish = `Jest godzina ${hNom[hours]} ${mWords[minutes]}`; 
        } else {
            let nextH = (hours + 1) % 24;
            if (!is24h) nextH = (hours + 1) % 12;
            if (minutes === 0) polish = `Jest ${hNom[displayHour]}`;
            else if (minutes === 15) polish = `Kwadrans po ${hGen[displayHour]}`;
            else if (minutes < 30) polish = `${mWords[minutes]} po ${hGen[displayHour]}`;
            else if (minutes === 30) {
                let nextGenH = (hours + 1) % 24;
                if (!is24h) nextGenH = (hours + 1) % 12;
                polish = `WpÃ³Å‚ do ${hGen[nextGenH]}`;
            }
            else if (minutes === 45) polish = `Za kwadrans ${hNom[nextH]}`;
            else polish = `Za ${mWords[60 - minutes]} ${hNom[nextH]}`;
        }

        const textField = document.getElementById('polish-text');
        if (isQuiz && !isRevealed) {
            textField.innerText = dict[currentLang].qAsk;
            document.getElementById('reveal-btn').style.display = "block";
        } else {
            textField.innerText = polish.charAt(0).toUpperCase() + polish.slice(1);
            document.getElementById('reveal-btn').style.display = "none";
        }
    }

    function speak(rate) {
        window.speechSynthesis.cancel();
        const text = document.getElementById('polish-text').innerText;
        if ((isQuiz && !isRevealed) || text.length < 2) return;
        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = 'pl-PL';
        msg.rate = rate;
        window.speechSynthesis.speak(msg);
    }

    function toggleHelp() {
        const modal = document.getElementById('help-modal');
        modal.style.display = (modal.style.display === 'block') ? 'none' : 'block';
    }

    function toggleDark() { document.body.classList.toggle('dark-mode'); }
</script>
</body>
</html>
